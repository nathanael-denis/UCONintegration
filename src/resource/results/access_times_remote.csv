89
25
12
14
Buyer address generated :atoi1qrkzqqfy6t6qm69mh9es6s4rauv3evvztjesntty7d7kzz2pwqdywcmqdkg
Transaction Id on networknetwork_id=8453507715857476362, nonce=2794, id=e81dfc41dd72f52a4daadff2bcc9daec75ff41f44203c3a94435ee054d88f911, payload=Some(MessagePayload { payload: Transaction(TransactionPayload { essence: Regular(RegularEssence { inputs: [Utxo(UtxoInput(00000000000000000000000000000000000000000000000000000000000000000000))], outputs: [SignatureLockedSingle(SignatureLockedSingleOutput { address: Ed25519(Ed25519Address(ec200124d2f40de8bbb9730d42a3ef191cb1825cb309ad64f37d610941701a47)), amount: 2779530282277761 }), SignatureLockedSingle(SignatureLockedSingleOutput { address: Ed25519(Ed25519Address(fa5d4c704afce9f26485e938ba989fcd308e0a44fdf1e69d798b401ad2fa43e4)), amount: 1000000 })], payload: None }), unlock_blocks: UnlockBlocks([Signature(Ed25519(Ed25519Signature { public_key: [45, 72, 196, 126, 194, 50, 223, 4, 107, 19, 190, 203, 87, 134, 204, 57, 240, 27, 135, 148, 221, 213, 255, 189, 120, 241, 138, 192, 31, 55, 141, 16], signature: [217, 96, 166, 44, 72, 253, 212, 213, 167, 34, 123, 88, 39, 78, 180, 209, 204, 192, 7, 64, 75, 60, 164, 29, 188, 132, 243, 201, 91, 109, 171, 154, 177, 125, 204, 168, 158, 88, 141, 216, 70, 229, 92, 167, 111, 141, 140, 11, 161, 250, 69, 130, 250, 169, 6, 12, 71, 14, 163, 61, 122, 21, 52, 14] }))]) }) }), parents=([MessageId(64f01d3109a7de2a44fb6db572884614eb0bf0fbd32794fd4174f1b9767e10ef), MessageId(a68df4b869d40905a12339192b34344ffba0f799931bafa0e1637afe093d6142), MessageId(ccec9af797369b6e773e95cde72964a966dbf8838cc03a3906e50b9ca127007d), MessageId(eb3f0400ac01997bef8f270e3eb8c9aba889276b47e06a4fb557981df64d1864)])
Transaction sent: http://localhost:8082/explorer/search/e81dfc41dd72f52a4daadff2bcc9daec75ff41f44203c3a94435ee054d88f911
atoi1qztx22lp5n69f4etlr6600qcdswrj8terzkga65msddc3sh4sdx02rxjqsq
1000000
The destination address is the data owner address
<Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" PolicyId="IOTAwUCONPolicy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:permit-overrides" Version="1.0">  <Target>     <AnyOf>        <AllOf>           <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">              <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">atoi1qztx22lp5n69f4etlr6600qcdswrj8terzkga65msddc3sh4sdx02rxjqsq</AttributeValue>              <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>           </Match>        </AllOf>     </AnyOf>  </Target>  <Rule Effect="Permit" RuleId="check-amount">    <Description>Authorise the user only if the amount is the expected value of the data</Description>    <Target>        <AnyOf>           <AllOf>              <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:integer-equal">                 <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer">atoi1qra96nrsft7wnunysh5n3w5cnlxnprs2gn7lre5a0x95qxkjlfp7geklsxf</AttributeValue>                 <AttributeDesignator AttributeId="http://iotawucon/nbiotas" Category="http://iotawucon/category" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>              </Match>           </AllOf>         </AnyOf>       </Target>    <AdviceExpressions>    <AdviceExpression AdviceId="permit-amount" AppliesTo="Permit">    <AttributeAssignmentExpression AttributeId="urn:oasis:names:tc:xacml:2.0:example:attribute:text">  <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">The amount of iotas paid is correct</AttributeValue>  </AttributeAssignmentExpression>    </AdviceExpression>    </AdviceExpressions></Rule><Rule Effect="Permit" RuleId="permit">  <Description>Authorise the user if the amount if the expected value of the data</Description>  <Target>      <AnyOf>         <AllOf>            <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:integer-equal">               <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">atoi1qpty45svr0r5s9nxatzaszkde8syt4etrsmea50pmc3l2swyskc0q8wlpjs</AttributeValue>               <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>            </Match>         </AllOf>       </AnyOf>     </Target>  <AdviceExpressions>  <AdviceExpression AdviceId="permit-amount" AppliesTo="Permit">  <AttributeAssignmentExpression AttributeId="urn:oasis:names:tc:xacml:2.0:example:attribute:text"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">The destination address is the data owner address</AttributeValue></AttributeAssignmentExpression>  </AdviceExpression>  </AdviceExpressions></Rule> <Rule RuleId="deny-rule" Effect="Deny"/></Policy>
<Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" PolicyId="IOTAwUCONPolicy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:permit-overrides" Version="1.0">  <Target>     <AnyOf>        <AllOf>           <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">              <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">atoi1qrkzqqfy6t6qm69mh9es6s4rauv3evvztjesntty7d7kzz2pwqdywcmqdkg</AttributeValue>              <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>           </Match>        </AllOf>     </AnyOf>  </Target>  <Rule Effect="Permit" RuleId="check-amount">    <Description>Authorise the user only if the amount is the expected value of the data</Description>    <Target>        <AnyOf>           <AllOf>              <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:integer-equal">                 <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer">1000000</AttributeValue>                 <AttributeDesignator AttributeId="http://iotawucon/nbiotas" Category="http://iotawucon/category" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>              </Match>           </AllOf>         </AnyOf>       </Target>    <AdviceExpressions>    <AdviceExpression AdviceId="permit-amount" AppliesTo="Permit">    <AttributeAssignmentExpression AttributeId="urn:oasis:names:tc:xacml:2.0:example:attribute:text">  <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">The amount of iotas paid is correct</AttributeValue>  </AttributeAssignmentExpression>    </AdviceExpression>    </AdviceExpressions></Rule><Rule Effect="Permit" RuleId="permit">  <Description>Authorise the user if the amount if the expected value of the data</Description>  <Target>      <AnyOf>         <AllOf>            <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:integer-equal">               <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">atoi1qpty45svr0r5s9nxatzaszkde8syt4etrsmea50pmc3l2swyskc0q8wlpjs</AttributeValue>               <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>            </Match>         </AllOf>       </AnyOf>     </Target>  <AdviceExpressions>  <AdviceExpression AdviceId="permit-amount" AppliesTo="Permit">  <AttributeAssignmentExpression AttributeId="urn:oasis:names:tc:xacml:2.0:example:attribute:text"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">The destination address is the data owner address</AttributeValue></AttributeAssignmentExpression>  </AdviceExpression>  </AdviceExpressions></Rule> <Rule RuleId="deny-rule" Effect="Deny"/></Policy>
<Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" PolicyId="IOTAwUCONPolicy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:permit-overrides" Version="1.0">  <Target>     <AnyOf>        <AllOf>           <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">              <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">atoi1qztx22lp5n69f4etlr6600qcdswrj8terzkga65msddc3sh4sdx02rxjqsq</AttributeValue>              <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>           </Match>        </AllOf>     </AnyOf>  </Target>  <Rule Effect="Permit" RuleId="check-amount">    <Description>Authorise the user only if the amount is the expected value of the data</Description>    <Target>        <AnyOf>           <AllOf>              <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:integer-equal">                 <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer">1000000</AttributeValue>                 <AttributeDesignator AttributeId="http://iotawucon/nbiotas" Category="http://iotawucon/category" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>              </Match>           </AllOf>         </AnyOf>       </Target>    <AdviceExpressions>    <AdviceExpression AdviceId="permit-amount" AppliesTo="Permit">    <AttributeAssignmentExpression AttributeId="urn:oasis:names:tc:xacml:2.0:example:attribute:text">  <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">The amount of iotas paid is correct</AttributeValue>  </AttributeAssignmentExpression>    </AdviceExpression>    </AdviceExpressions></Rule><Rule Effect="Permit" RuleId="permit">  <Description>Authorise the user if the amount if the expected value of the data</Description>  <Target>      <AnyOf>         <AllOf>            <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:integer-equal">               <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">atoi1qpty45svr0r5s9nxatzaszkde8syt4etrsmea50pmc3l2swyskc0q8wlpjs</AttributeValue>               <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>            </Match>         </AllOf>       </AnyOf>     </Target>  <AdviceExpressions>  <AdviceExpression AdviceId="permit-amount" AppliesTo="Permit">  <AttributeAssignmentExpression AttributeId="urn:oasis:names:tc:xacml:2.0:example:attribute:text"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">1000000</AttributeValue></AttributeAssignmentExpression>  </AdviceExpression>  </AdviceExpressions></Rule> <Rule RuleId="deny-rule" Effect="Deny"/></Policy>
XACML request
<Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" CombinedDecision="false" ReturnPolicyIdList="false">
<Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject">
<Attribute AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" IncludeInResult="false">
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">atoi1qrkzqqfy6t6qm69mh9es6s4rauv3evvztjesntty7d7kzz2pwqdywcmqdkg</AttributeValue>
</Attribute>
</Attributes>
<Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject">
<Attribute AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" IncludeInResult="false">
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">atoi1qra96nrsft7wnunysh5n3w5cnlxnprs2gn7lre5a0x95qxkjlfp7geklsxf</AttributeValue>
</Attribute>
</Attributes>
<Attributes Category="http://iotawucon/category">
<Attribute AttributeId="http://iotawucon/nbiotas" IncludeInResult="false">
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer">1000000</AttributeValue>
</Attribute>
</Attributes>
</Request>

 XACML response
<Response xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"><Result><Decision>Permit</Decision><Status><StatusCode Value="urn:oasis:names:tc:xacml:1.0:status:ok"/></Status><AssociatedAdvice><Advice AdviceId="permit-amount" ><AttributeAssignment  AttributeId="urn:oasis:names:tc:xacml:2.0:example:attribute:text" DataType="http://www.w3.org/2001/XMLSchema#string">The amount of iotas paid is correct</AttributeAssignment>
</Advice><Advice AdviceId="permit-amount" ><AttributeAssignment  AttributeId="urn:oasis:names:tc:xacml:2.0:example:attribute:text" DataType="http://www.w3.org/2001/XMLSchema#string">The amount of iotas paid is correct</AttributeAssignment>
</Advice></AssociatedAdvice></Result><Result><Decision>Permit</Decision><Status><StatusCode Value="urn:oasis:names:tc:xacml:1.0:status:ok"/></Status><AssociatedAdvice><Advice AdviceId="permit-amount" ><AttributeAssignment  AttributeId="urn:oasis:names:tc:xacml:2.0:example:attribute:text" DataType="http://www.w3.org/2001/XMLSchema#string">The amount of iotas paid is correct</AttributeAssignment>
</Advice><Advice AdviceId="permit-amount" ><AttributeAssignment  AttributeId="urn:oasis:names:tc:xacml:2.0:example:attribute:text" DataType="http://www.w3.org/2001/XMLSchema#string">The amount of iotas paid is correct</AttributeAssignment>
</Advice></AssociatedAdvice></Result></Response>

 User with address atoi1qrkzqqfy6t6qm69mh9es6s4rauv3evvztjesntty7d7kzz2pwqdywcmqdkg paid 1000000 iotas to user atoi1qra96nrsft7wnunysh5n3w5cnlxnprs2gn7lre5a0x95qxkjlfp7geklsxf

 User with address atoi1qrkzqqfy6t6qm69mh9es6s4rauv3evvztjesntty7d7kzz2pwqdywcmqdkg is authorized to access this data


true
